# ğŸ“˜ ãƒ‰ãƒ¡ã‚¤ãƒ³ãƒ«ãƒ¼ãƒ«ä¸€è¦§ï¼ˆbudget_book - v2.4ï¼‰

---

æœ¬ãƒ‰ã‚­ãƒ¥ãƒ¡ãƒ³ãƒˆã§ã¯ã€budget_book ã«ç™»å ´ã™ã‚‹ä¸»è¦ãƒ‰ãƒ¡ã‚¤ãƒ³ã‚ªãƒ–ã‚¸ã‚§ã‚¯ãƒˆã¨ã€ãã‚Œãã‚Œã®å±æ€§ãƒ»ãƒãƒªãƒ‡ãƒ¼ã‚·ãƒ§ãƒ³ãƒ»ä¸å¤‰æ¡ä»¶ã‚’å®šç¾©ã™ã‚‹ã€‚  
ZodãŠã‚ˆã³TypeScriptå‹ã«åŸºã¥ãæ§‹é€ ã‚’æƒ³å®šã—ã€ã‚«ãƒ©ãƒ å®šç¾©ã¯å®Ÿè£…ï¼ˆãƒ‡ãƒ¼ã‚¿ãƒ¢ãƒ‡ãƒ«è¨­è¨ˆï¼‰ã«æº–æ‹ ã™ã‚‹ã€‚

---

## ğŸ§¾ Entryï¼ˆåæ”¯è¨˜éŒ²ï¼‰

### ç”¨é€” - åæ”¯è¨˜éŒ²

åå…¥ãƒ»æ”¯å‡ºãƒ»å€Ÿå…¥ãƒ»è²¸ä»˜ãƒ»è¿”æ¸ˆãªã©ã€ã™ã¹ã¦ã®é‡‘éŠ­ã®å‹•ãã‚’è¨˜éŒ²ã™ã‚‹åŸºæœ¬å˜ä½ã€‚  
**å€Ÿå…¥ï¼è²¸ä»˜ã¯`Debt`ã¨ã‚»ãƒƒãƒˆã§ç”Ÿæˆã•ã‚Œã‚‹ã€‚è¿”æ¸ˆãªã©ã®è¤‡æ•°æ”¯æ‰•ã„ãŒ1ã¤ã®Debtã«ç´ã¥ãã“ã¨ã‚‚ã‚ã‚‹ã€‚**

### å±æ€§ - åæ”¯è¨˜éŒ²

| ãƒ•ã‚£ãƒ¼ãƒ«ãƒ‰ | å‹ | å¿…é ˆ | èª¬æ˜ |
|------------|----|------|------|
| `id` | string (UUID) | âœ” | ä¸€æ„ãªè­˜åˆ¥å­ |
| `type` | 'income' \| 'expense' \| 'borrow' \| 'lend' \| 'repayment' \| 'repay_received' \| 'transfer' \| 'initial_balance'ï¼ˆZod Enumï¼‰ | âœ” | é‡‘éŠ­ã®æµã‚Œã®ç¨®åˆ¥ |
| `date` | Dateï¼ˆãƒ­ãƒ¼ã‚«ãƒ«ã‚¿ã‚¤ãƒ åŸºæº–ï¼‰ | âœ” | ç™ºç”Ÿæ—¥ |
| `amount` | Decimal | âœ” | é‡‘é¡ï¼ˆæ­£ã®æ•°ï¼‰ |
| `method` | string | âœ” | æ”¯æ‰•ã„æ–¹æ³•ã®è­˜åˆ¥å­ï¼ˆMethodã¸ã®å‚ç…§ï¼‰ |
| `category` | string | âœ– | ä»»æ„ã‚«ãƒ†ã‚´ãƒªï¼ˆåæ”¯ã®ã¿ä½¿ç”¨ï¼‰ã€‚typeã¨ã‚«ãƒ†ã‚´ãƒªåˆ†é¡ãŒä¸€è‡´ã—ã¦ã„ã‚‹å¿…è¦ã‚ã‚Š |
| `purpose` | string | âœ– | è¡¨å‘ãã®ä½¿é€”ã€‚è©³ç´°ãªå†…å®¹ã«ãªã‚‹ã“ã¨ã‚‚ã‚ã‚‹ã€‚é›†è¨ˆã‚„UIè¡¨ç¤ºå¯¾è±¡ |
| `privatePurpose` | string | âœ– | éå…¬é–‹ãªå®Ÿéš›ã®ä½¿é€”ã€‚è©³ç´°ãªè¨˜è¿°ãŒã•ã‚Œã‚‹ã“ã¨ãŒã‚ã‚‹ã€‚é›†è¨ˆãƒ»è¡¨ç¤ºã‹ã‚‰ã¯é™¤å¤–ã•ã‚Œã‚‹ |
| `note` | string | âœ– | è£œè¶³æƒ…å ±ï¼ˆã‚¿ã‚°ã€çŠ¶æ³ã€æ–‡è„ˆãªã©ã®è‡ªç”±è¨˜è¿°ï¼‰ |
| `evidenceNote` | string | âœ– | è¨¼æ†‘ã«é–¢ã™ã‚‹æƒ…å ±ã€‚URIãŒå«ã¾ã‚Œã‚‹å ´åˆã€ãã‚Œã¯**ã‚¢ãƒ—ãƒªå†…ã«ä¿å­˜ã•ã‚ŒãŸãƒªã‚½ãƒ¼ã‚¹**ã§ãªã‘ã‚Œã°ãªã‚‰ãªã„ï¼ˆå¤–éƒ¨URLç¦æ­¢ï¼‰ |
| `debtId` | string (UUID) | âœ– | å¯¾å¿œã™ã‚‹Debtã®IDï¼ˆå€Ÿå…¥ï¼è²¸ä»˜ï¼è¿”æ¸ˆãƒ»è¿”æ¸ˆå—å–æ™‚ï¼‰ |
| `createAt` | Date | âœ” | Entryã‚’ä½œæˆã—ãŸæ—¥æ™‚ |

### ä¸å¤‰æ¡ä»¶ - åæ”¯è¨˜éŒ²

- `amount > 0`
- `type`ãŒ`borrow` / `lend`ã®å ´åˆã€`debtId`ã¯å¿…é ˆ
- `type`ãŒ`repayment` / `repay_received` ã®å ´åˆã‚‚ã€`debtId`ã¯å¿…é ˆ
- `type`ãŒ`transfer` ã®å ´åˆã€toMethodId ã‚„ Transferãƒ¢ãƒ‡ãƒ«ã§å¯¾ã«ãªã‚‹ã‚¨ãƒ³ãƒˆãƒªãŒå­˜åœ¨ã™ã‚‹å¿…è¦ãŒã‚ã‚‹ï¼ˆâ€»æ§‹é€ ã§ç®¡ç†ï¼‰
- `type`ãŒ`initial_balance` ã®å ´åˆã€Methodä½œæˆæ™‚ã®åˆæœŸEntryã§ã‚ã‚‹ã“ã¨

---

## ğŸ’³ Debtï¼ˆè²¸å€Ÿç®¡ç†ï¼‰

### ç”¨é€” - è²¸å€Ÿç®¡ç†

å€Ÿå…¥ï¼è²¸ä»˜ã®çŠ¶æ…‹ç®¡ç†ãŠã‚ˆã³é€²æ—ã®å‚ç…§ã€‚

### å±æ€§ - è²¸å€Ÿç®¡ç†

| ãƒ•ã‚£ãƒ¼ãƒ«ãƒ‰ | å‹ | å¿…é ˆ | èª¬æ˜ |
|------------|----|------|------|
| `id` | string (UUID) | âœ” | ä¸€æ„ãªè­˜åˆ¥å­ |
| `type` | 'borrow' / 'lend' | âœ” | å€Ÿå…¥ or è²¸ä»˜ |
| `entryId` | string (UUID) | âœ” | èµ·ç‚¹ã¨ãªã‚‹Entryã®ID |
| `date` | Date | âœ” | ç™ºç”Ÿæ—¥ |
| `amount` | Decimal | âœ” | é‡‘é¡ï¼ˆå…ƒæœ¬ï¼‰ |
| `counterpart` | string | âœ” | ç›¸æ‰‹ã®åå‰ or è­˜åˆ¥æƒ…å ± |
| `repaidAt` | Date | âœ– | è¿”æ¸ˆå®Œäº†æ—¥ï¼ˆã‚ã‚Œã°ï¼‰ |
| `memo` | string | âœ– | ä»»æ„ã®å‚™è€ƒ |

### ä¸å¤‰æ¡ä»¶ - è²¸å€Ÿç®¡ç†

- `amount > 0`
- `entryId`ã®`type`ã¯`borrow`ã¾ãŸã¯`lend`ã§ã‚ã‚‹ã“ã¨
- `repaidAt`ãŒã‚ã‚‹å ´åˆã€`date <= repaidAt`

---

## ğŸ’° Methodï¼ˆæ”¯æ‰•ã„æ‰‹æ®µï¼‰

### ç”¨é€” - æ”¯æ‰•ã„æ‰‹æ®µ

å£åº§ã€ç¾é‡‘ã€é›»å­ãƒãƒãƒ¼ãªã©ã€æ”¯æ‰•ã„æ‰‹æ®µã‚’è¡¨ã™ã€‚

### å±æ€§ - æ”¯æ‰•ã„æ‰‹æ®µ

| ãƒ•ã‚£ãƒ¼ãƒ«ãƒ‰ | å‹ | å¿…é ˆ | èª¬æ˜ |
|------------|----|------|------|
| `id` | string (UUID) | âœ” | ä¸€æ„ãªè­˜åˆ¥å­ |
| `name` | string | âœ” | è¡¨ç¤ºå |
| `initialBalance` | number | âœ– | åˆæœŸæ®‹é«˜ï¼ˆã‚ã‚Œã°ï¼‰ |
| `archived` | boolean | âœ– | ä½¿ç”¨åœæ­¢ãƒ•ãƒ©ã‚°ï¼ˆUIéè¡¨ç¤ºï¼‰ |

---

## ğŸ“Š Reportï¼ˆæœˆæ¬¡ãƒ¬ãƒãƒ¼ãƒˆï¼‰

### ç”¨é€” - æœˆæ¬¡ãƒ¬ãƒãƒ¼ãƒˆ

æœˆå˜ä½ã®åæ”¯é›†è¨ˆã€methodåˆ¥è³‡ç”£æ¨ç§»ã€ã‚«ãƒ†ã‚´ãƒªåˆ¥æ”¯å‡ºå‰²åˆãªã©ã‚’è¡¨ç¤ºã€‚

### å±æ€§ï¼ˆé›†è¨ˆç”¨ãƒ¢ãƒ‡ãƒ«ï¼‰

| ãƒ•ã‚£ãƒ¼ãƒ«ãƒ‰ | å‹ | èª¬æ˜ |
|------------|----|------|
| `month` | string (YYYY-MM) | å¯¾è±¡æœˆ |
| `totalIncome` | number | æœˆã®ç·åå…¥ |
| `totalExpense` | number | æœˆã®ç·æ”¯å‡º |
| `net` | number | æœˆã®åæ”¯å·®åˆ† |
| `methodBalances` | Record<method, number> | æœˆæœ«æ™‚ç‚¹ã®methodåˆ¥æ®‹é«˜ |
| `categoryBreakdown` | Record<category, number> | æ”¯å‡ºã‚«ãƒ†ã‚´ãƒªåˆ¥åˆè¨ˆ |

---

## ğŸ” Transferï¼ˆå£åº§é–“æŒ¯æ›¿ï¼‰

### ç”¨é€” - å£åº§é–“æŒ¯æ›¿

ãƒ¦ãƒ¼ã‚¶ãƒ¼ã®æ‰€æœ‰ã™ã‚‹è¤‡æ•°ã®æ”¯æ‰•ã„æ–¹æ³•ï¼ˆMethodï¼‰é–“ã®è³‡é‡‘ç§»å‹•ã‚’è¨˜éŒ²ã™ã‚‹ãŸã‚ã®è£œåŠ©ãƒ¢ãƒ‡ãƒ«ã€‚Entryã®`type = transfer`ã¨1å¯¾1ã§çµã³ã¤ãã€‚

### ãƒ•ã‚£ãƒ¼ãƒ«ãƒ‰å®šç¾©

| ãƒ•ã‚£ãƒ¼ãƒ«ãƒ‰ | å‹ | å¿…é ˆ | èª¬æ˜ |
|------------|----|------|------|
| id | string (UUID) | âœ” | ä¸€æ„ãªè­˜åˆ¥å­ |
| rootEntryId | string (UUID) | âœ” | å¯¾å¿œã™ã‚‹Entryã®ID |
| fromMethodId | string (UUID) | âœ” | ç§»å‹•å…ƒã®Method |
| toMethodId | string (UUID) | âœ” | ç§»å‹•å…ˆã®Method |
| date | DateTime | âœ” | ç™ºç”Ÿæ—¥ï¼ˆEntryã¨ä¸€è‡´ï¼‰ |
| note | string | âœ– | ä»»æ„ã®è£œè¶³èª¬æ˜ |

---

## ğŸ—‚ï¸ Metaãƒ¢ãƒ‡ãƒ«ç¾¤ï¼ˆè¡¨ç¤ºï¼åˆ†é¡ç”¨ï¼‰

### ç”¨é€” - è¡¨ç¤º/åˆ†é¡ç”¨

Enumã§å®šç¾©ã•ã‚ŒãŸå‹ã«å¯¾ã—ã€è¡¨ç¤ºç”¨ã®ãƒ©ãƒ™ãƒ«ã‚„èª¬æ˜ã€è‰²ãªã©ã®ãƒ¡ã‚¿æƒ…å ±ã‚’æä¾›ã—ã€UIãŠã‚ˆã³è«–ç†å‡¦ç†ã®æŸ”è»Ÿæ€§ã‚’ç¢ºä¿ã™ã‚‹ã€‚

---

### ğŸ“˜ EntryTypeMeta

| ãƒ•ã‚£ãƒ¼ãƒ«ãƒ‰ | å‹ | å¿…é ˆ | èª¬æ˜ |
|------------|----|------|------|
| type | EntryType | âœ” | enum EntryType ã®è­˜åˆ¥å­ |
| label | string | âœ” | è¡¨ç¤ºãƒ©ãƒ™ãƒ« |
| description | string | âœ– | èª¬æ˜æ–‡ |
| color | string | âœ– | è¡¨ç¤ºè‰² |
| icon | string | âœ– | ã‚¢ã‚¤ã‚³ãƒ³ï¼ˆUIã§ä½¿ç”¨ï¼‰ |
| sortOrder | number | âœ– | è¡¨ç¤ºé †åºç”¨ã®ä¸¦ã³é †ã‚­ãƒ¼ |

---

### ğŸ“˜ DebtTypeMeta

| ãƒ•ã‚£ãƒ¼ãƒ«ãƒ‰ | å‹ | å¿…é ˆ | èª¬æ˜ |
|------------|----|------|------|
| type | DebtType | âœ” | enum DebtType ã®è­˜åˆ¥å­ |
| label | string | âœ” | è¡¨ç¤ºãƒ©ãƒ™ãƒ« |
| description | string | âœ– | èª¬æ˜æ–‡ |
| color | string | âœ– | è¡¨ç¤ºè‰² |
| icon | string | âœ– | ã‚¢ã‚¤ã‚³ãƒ³ï¼ˆUIã§ä½¿ç”¨ï¼‰ |
| sortOrder | number | âœ– | è¡¨ç¤ºé †åºç”¨ã®ä¸¦ã³é †ã‚­ãƒ¼ |

---

### ğŸ“˜ CategoryTypeMeta

| ãƒ•ã‚£ãƒ¼ãƒ«ãƒ‰ | å‹ | å¿…é ˆ | èª¬æ˜ |
|------------|----|------|------|
| type | CategoryType | âœ” | enum CategoryType ã®è­˜åˆ¥å­ |
| label | string | âœ” | è¡¨ç¤ºãƒ©ãƒ™ãƒ« |
| description | string | âœ– | èª¬æ˜æ–‡ |
| color | string | âœ– | è¡¨ç¤ºè‰² |
| icon | string | âœ– | ã‚¢ã‚¤ã‚³ãƒ³ï¼ˆUIã§ä½¿ç”¨ï¼‰ |
| sortOrder | number | âœ– | è¡¨ç¤ºé †åºç”¨ã®ä¸¦ã³é †ã‚­ãƒ¼ |

---

## ğŸ”” NotificationRuleï¼ˆé€šçŸ¥è¨­å®šï¼‰â€»ç¾åœ¨ã¯æœªä½¿ç”¨ãƒ»å°†æ¥çš„æ‹¡å¼µç”¨é€”ã¨ã—ã¦å‡çµä¸­

| ãƒ•ã‚£ãƒ¼ãƒ«ãƒ‰ | å‹ | å¿…é ˆ | èª¬æ˜ |
|------------|----|------|------|
| `id` | string | âœ” | é€šçŸ¥ãƒ«ãƒ¼ãƒ«ID |
| `event` | string | âœ” | é€šçŸ¥ã‚¤ãƒ™ãƒ³ãƒˆåï¼ˆ"debt_due", "monthly_summary"ãªã©ï¼‰ |
| `channel` | 'push' / 'google' | âœ” | é€šçŸ¥å…ˆ |
| `timing` | 'immediate' / 'daily' / 'monthly' | âœ” | é€šçŸ¥ã‚¿ã‚¤ãƒŸãƒ³ã‚° |

---

## ğŸ—‚ï¸ ãã®ä»–è£œåŠ©ãƒ‰ãƒ¡ã‚¤ãƒ³ï¼ˆã‚«ãƒ†ã‚´ãƒªãªã©ï¼‰

- **Category**  
  - `id: string`, `name: string`, `type: 'income' | 'expense'`
  - UIç·¨é›†å¯èƒ½ãƒ»å‹ã®åˆ¶é™ã‚ã‚Š
- **UserSettingï¼ˆå°†æ¥çš„ãªå¤šæ©Ÿèƒ½åŒ–ç”¨ï¼‰**  
  - `preferredNotification`, `defaultMethod`, `LLMAssistantEnabled` ãªã©

---

ä»¥ä¸ŠãŒç¾æ™‚ç‚¹ã§ã®ãƒ‰ãƒ¡ã‚¤ãƒ³å®šç¾©ã§ã‚ã‚‹ã€‚
